<html>
<title>US Road Traffic Mortality</title>
<script src="https://d3js.org/d3.v5.js"></script>
<style>
  div.tooltip {
    position: absolute;
    text-align: center;
    background-color: white;
    border: solid;
    border-radius: 5px;
    border-width: 2px;
    padding: 5px;
    pointer-events: none;
  }
</style>
<body onload='init()'>
<h1>US Road Traffic Mortality</h1>
<p>Amanda Wang</p>
<p>July 23, 2021</p>
<p>&nbsp;</p>
<p>INSERT TEXT HERE</p>
<svg width=1000 height=1000></svg>
<script>
async function init() {
  data = await d3.csv("https://awang288.github.io/raw_data/US_data.csv");
  var width=750;
  var height=750;
  var margin=100;

  var xs=d3.scaleLinear().domain([1999,2021]).range([0,width]);
  var ys=d3.scaleLinear().domain([11,16.5]).range([height,0]);
  var xTickLabels=["2000","2005","2010","2015","2020"]
  div = d3.select("body").append("div")	
    .attr("class", "tooltip")				
    .style("opacity", 0); 

  
  d3.select("svg")
    .attr("width",width+2*margin)
    .attr("height",height+2*margin)
    .append("g").attr("transform","translate("+margin+","+margin+")")
    .selectAll("body").data(data).enter().append("path")
    .datum(data)
    .attr("fill","none")
    .attr("stroke", "skyblue")
    .attr("stroke-width", 1.5)
    .attr("d", d3.line()
      .x(function(d) { return x(d.Year) })
      .y(function(d) { return y(d.Value) }))
  

  d3.select("svg")
    .attr("width",width+2*margin)
    .attr("height",height+2*margin)
    .append("g").attr("transform","translate("+margin+","+margin+")")
    .selectAll("body").data(data).enter().append("circle")
    .attr("cx",function(d) {return xs(d.Year);})
    .attr("cy",function(d) {return ys(d.Value);})
    .attr("r",5)
    .attr("fill",d3.color("blue"))
    .on("mouseover", function(d) {
      div.html("Year: "+d.Year+"<br>Number of Fatalities: "+d.Value+
          "<br>% of Deaths-Female: "+d.Female+"%<br>% of Deaths-Male: "+d.Male+"%")
        .style("top", (event.pageY)-105+"px")
        .style("left",(event.pageX)-60+"px")
        .style("opacity",.85);
        })
    .on("mouseout", function(d) {div.style("opacity", 0);});

  d3.select("svg").append("g")
    .attr("transform","translate("+margin+","+margin+")")
    .call(d3.axisLeft(ys));

  d3.select("svg").append("g")
    .attr("transform","translate("+margin+","+(height+margin)+")")
    .call(d3.axisBottom(xs)
          .ticks(5)
          .tickValues([2000,2005,2010,2015,2020])
          .tickFormat(function (d,i) {
            return xTickLabels[i]})
          );

  d3.select("svg").append("text")
    .attr("transform","translate("+(width/2+100)+","+(height+margin+50)+")")
    .style("text-anchor","middle")
    .text("Year");

  d3.select("svg").append("text")
    .attr("transform","rotate(-90)")
    .attr("y", 0-margin.left)
    .attr("x",-50-(height/2))
    .attr("dy","1em")
    .style("text-anchor","middle")
    .text("Number of Traffic-Related Fatalities per 100,000 population");

  d3.select("svg").append("text")
    .attr("x",(width/2-100))
    .attr("y",margin/2)
    .attr("text-anchor","center")
    .attr("font-weight",600)
    .style("font-size","24px")
    .text("Traffic-Related Fatalities in the United States");
}

</script>
<p>INSERT PAGE 1 TEXT</p>
<p>
<input type="button" onclick="location.href='est_road_deaths.html';" value="Next" />
</p>
</body>
</html>