<html>
<title>Road Traffic Mortality Around the World</title>
<script src="https://d3js.org/d3.v5.js"></script>
<style>
div.tooltip {
  position: absolute;
  text-align: center;
  width: 200px;
  height: 110px;
  background: white;
  border: 2px;
  pointer-events: none;
}
</style>
<body onload="init()">
<h1>Road Traffic Mortality Around the World</h1>
<p>&nbsp;</p>
<p>
    <input type="button" onclick="location.href='index.html';" value="Previous" />
    <input type="button" onclick="location.href='testing.html';" value="Next" />
</p>
<p>&nbsp;</p>
<p>INSERT TEXT HERE</p>
<svg width=1000 height=700></svg>
<select id="button"></select>
<script>
async function init() {
    data = await d3.csv("https://awang288.github.io/raw_data/Overall.csv");
    var width=800;
    var height=500;
    var margin=100;
    var xs=d3.scaleLog().domain([90,120000]).range([0,width]);
    var ys=d3.scaleLinear().domain([0,65]).range([height,0]);
    const regions=["East Asia & Pacific","Europe & Central Asia","Latin America & Caribbean",
    "Middle East & North Africa","North America","South Asia","Sub-Saharan Africa"]
    var years=[2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019]
    const colors=d3.scaleOrdinal().domain(regions).range(d3.schemeSet2)
  
    d3.select("#button").selectAll("myOptions").data(years)
        .enter().append("option").text(function (d) {return d;})
        .attr("value",function(d) {return d;})

    div = d3.select("body").append("div")	
        .attr("class", "tooltip")				
        .style("opacity", 0); 

d3.select("svg")
    .attr("width",width+2*margin)
    .attr("height",height+2*margin)
    .append("g").attr("transform","translate("+margin+","+margin+")")
    .selectAll("body").data(data).enter().append("circle")
    .filter(function(d) {return d.Year==2000;})
    .attr("class", function(d) { return "dots " + d.Region})
    .attr("cx", function (d) { return xs(d.GDP); })
    .attr("cy", function (d) { return ys(d.Value); })
    .attr("r", 5)
    .style("fill", function (d) { return colors(d['Region']) })
    .on("mouseover", function(d) {
          div.html("Country: "+d.Country+"<br>Region: "+d.regions
            +"<br>GDP per Capita: "+d.GDP+"<br>Fatalities: "
            +d.Value+"<br>% of Fatalities-Female: "+d.Female+"<br>% of Fatalities-Male: "+d.Male)
            .style("top", (event.pageY)-105+"px")
            .style("left",(event.pageX)-60+"px")
            .style("opacity", .85);		
        })					
    .on("mouseout", function(d) {		
      div.style("opacity", 0);})

d3.select("svg").append("g")
    .attr("transform","translate("+margin+","+margin+")")
    .call(d3.axisLeft(ys)
      .tickArguments([12,"$.0s"])
);
d3.select("svg").append("g")
    .attr("transform","translate("+margin+","+(height+margin)+")")
    .call(d3.axisBottom(xs)
      .tickArguments([10,".0"])
);

d3.select("svg").append("text")
    .attr("transform","translate("+(width/2+100)+","+(height+margin+50)+")")
    .style("text-anchor","middle")
    .text("GDP per Capita");
d3.select("svg").append("text")
    .attr("transform","rotate(-90)")
    .attr("y", 0-margin.left)
    .attr("x",-50-(height/2))
    .attr("dy","1em")
    .style("text-anchor","middle")
    .text("Number of Traffic-Related Fatalities per 100,000 population");

d3.select("#button").on("change", function(d) {
    var selectedOption = d3.select(this).property("value");
    d3.selectAll("circle").remove();
    d3.select("svg")
    .attr("width",width+2*margin)
    .attr("height",height+2*margin)
    .append("g").attr("transform","translate("+margin+","+margin+")")
    .selectAll("body").data(data).enter().append("circle")
    .filter(function(d) {return d.Year==selectedOption})
    .attr("class", function(d) { return "dots " + d.Region})
    .attr("cx", function (d) { return xs(d.GDP); })
    .attr("cy", function (d) { return ys(d.Value); })
    .attr("r", 5)
    .style("fill", function (d) { return colors(d['Region']) })
    .on("mouseover", function(d) {
          div.html("Country: "+d.Country+"<br>Region: "+d.regions
            +"<br>GDP per Capita: "+d.GDP+"<br>Fatalities: "
            +d.Value+"<br>% of Fatalities-Female: "+d.Female+"<br>% of Fatalities-Male: "+d.Male)
            .style("top", (event.pageY)-105+"px")
            .style("left",(event.pageX)-60+"px")
            .style("opacity", .85);		
        })					
    .on("mouseout", function(d) {		
      div.style("opacity", 0);})
    })
}

</script>

<p>INSERT TEXT HERE</p>
</body>
</html>