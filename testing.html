<html></html><script src="https://d3js.org/d3.v5.js"></script>


<title>Road Traffic Mortality Around the World</title>
<h1>Road Traffic Mortality Around the World</h1>
<body>
<h2>INSERT HEADING FOR PAGE 2</h2>
<p>INSERT PAGE 2 TEXT</p>
<div id="my_dataviz"></div>
<select id="button"></select>
<style>
    .myCircle:hover {fill: #E8336D;}
</style>

<script>
  var width=750;
  var height=750;
  var margin=100;
  var svg=d3.select("#my_dataviz").append("svg")
    .attr("width",width+2*margin)
    .attr("width",height+2*margin)
    .append("g")
    .attr("transform", "translate(" + margin + ", " + margin + ")");

  d3.csv('https://awang288.github.io/raw_data/Overall.csv',
    
    async function(data){
        // x axis
        var x=d3.scaleLog().domain([90,120000]).range([0,width])
        svg.append("g")
            .attr("transform","translate("+margin+","+(height+margin)+")")
            .call(d3.axisBottom(x).ticks(10))
        svg.append("text")
            .attr("transform","translate("+(width/2+100)+","+(height+margin+50)+")")
            .attr("class","x label")
            .style("text-anchor","middle")
            .text("GDP per Capita");
        // y axis
        var y=d3.scaleLinear().domain([0,65]).range([height,0]);
        svg.append("g")
            .attr("transform","translate("+margin+","+margin+")")
            .call(d3.axisLeft(y).ticks(10));
        svg.append("text")
            .attr("transform","rotate(-90)")
            .attr("class","y label")
            .attr("y", 0-margin.left)
            .attr("x",-50-(height/2))
            //.attr("dy","1em")
            .style("text-anchor","middle")
            .text("Number of Traffic-Related Fatalities per 100,000 population");

        // Title
        svg.append("text")
            .attr("x",(width/2-100))
            .attr("y",margin/2)
            .attr("text-anchor","center")
            .attr("font-weight",600)
            .style("font-size","24px")
            .text("Traffic-Related Fatalities Around the World");

        // tooltip
        var tooltip=d3.select("#my_dataviz")
            .append("div")
            .style("opacity",0)
            .attr("class","tooltip")
            .style("background-color","white")
            .style("border","solid")
            .style("border-width","2px")
            .style("border-radius","5px")
            .style("padding","5px")
            .style("position","absolute") 

        const regions=["East Asia & Pacific","Europe & Central Asia","Latin America & Caribbean",
            "Middle East & North Africa","North America","South Asia","Sub-Saharan Africa"]
        var years=[2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019]
        const colors=d3.scaleOrdinal().domain(regions).range(d3.schemeSet2)

        svg.append("g").selectAll("datapoints").data(data).enter().append("circle")
            .attr("class","myCircle")
            .filter(function(d) {return d.Year==2000;})
            .attr("cx",function(d) {return xs(d.GDP);})
            .attr("cy",function(d) {return ys(d.Value);})
            .attr("r",function(d) {return 7;})
            .attr("stroke",function(d){return colors(d["Region"])})
            .attr("stroke-width",2)
            .attr("fill","white")
            .on("mouseover", function(d) {
                        tooltip.style("opacity", 1)
                ;})
            .on("mousemove",function(d) {
                    tooltip
                    .html("Country: "+d.Country+"<br>Region: "+d.regions
                    +"<br>GDP per Capita: "+d.GDP+"<br>Fatalities: "
                    +d.Value+"<br>% of Fatalities-Female: "+d.Female+"<br>% of Fatalities-Male: "+d.Male)
                    .style("top", (event.pageY)-105+"px")
                    .style("left",(event.pageX)-60+"px")
                ;})
            .on("mouseleave", function(d) { 
                    tooltip.style("opacity", 0)
                ;})


        svg.append("line")
            .attr("x1", 150 )
            .attr("y1", 430 )
            .attr("x2", 100)
            .attr("y2", 331)
            .attr("stroke", "#E8336D")
            .attr("stroke-width", "1");        

        svg.append("text")
            .attr("x", 17)
            .attr("y", 252)
            .attr("fill", "#E8336D")
            .text("Low GDP per Capita")
            .style("font-family", "Lato")
            .style("font-style", "normal")
            .style("font-weight", "900");

        d3.select("#button").selectAll("myOptions").data(years)
            .enter().append("option").text(function (d) {return d;})
            .attr("value",function(d) {return d;})

        d3.select("#button").on("change", function(d) {
            var selectedOption = d3.select(this).property("value");
            d3.selectAll("circle").remove();
            svg
            .attr("width",width+2*margin)
            .attr("height",height+2*margin)
            .append("g")
            .attr("transform","translate("+margin+","+margin+")")
            .selectAll("body").data(data).enter().append("circle")
            .filter(function(d) {return d.Year==selectedOption})
            .attr("cx",function(d) {return xs(d.GDP);})
            .attr("cy",function(d) {return ys(d.Value);})
            .attr("r",function(d) {return 7;})
            .attr("fill",function(d){return colors(d["Region"])})
            .on("mouseover", function(d) {
                tooltip.style("opacity", 1)
                .transition().duration('50');})
            .on("mousemove",function(d) {
                tooltip.html("Country: "+d.Country+"<br>Region: "+d.regions
                +"<br>GDP per Capita: "+d.GDP+"<br>Fatalities: "
                +d.Value+"<br>% of Fatalities-Female: "+d.Female+"<br>% of Fatalities-Male: "+d.Male)
                .style("top", (event.pageY)-105+"px")
                .style("left",(event.pageX)-60+"px")
                .transition().duration('50');})
            .on("mouseleave", function(d) { 
                tooltip.style("opacity", 0)
                .transition().duration('50');})
        })
    })

</script>
<p>INSERT PAGE 2 TEXT</p>
<p style="text-align: center;"><span style="color: #99cc00;"><a href="https://awang288.github.io/index.html" title="Previous" style="color: #e8336d;"><strong>Previous--&gt;</strong></a></span></p>

</body>
</html>